<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Panel Paciente — <span th:text="${nombreUsuario}">Paciente</span></title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

  <style>
    /* Variables de color */
    :root {
      --primary: #0b3d91;
      --secondary: #ffffff;
      --accent: #f39c12;
      --bg: #f2f4f7;
      --card-bg: #ffffff;
      --text: #333333;
      --text-muted: #6c757d;
      --border: #dee2e6;
      --shadow-sm: rgba(0,0,0,0.05);
      --shadow-md: rgba(0,0,0,0.1);
    }
    *, *::before, *::after { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; height: 100%; font-family: "Segoe UI", sans-serif; background: var(--bg); color: var(--text); }
    a { text-decoration: none; }

    /* Layout */
    #sidebar { position: fixed; top: 0; left: 0; width: 240px; height: 100vh; background: var(--primary); color: var(--secondary); padding: 1.5rem 1rem; overflow-y: auto; }
    #topbar { position: fixed; top: 0; left: 240px; right: 0; height: 56px; background: var(--secondary); border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: flex-end; padding: 0 1.5rem; z-index: 900; }
    #content { margin-top: 56px; margin-left: 240px; padding: 2rem; min-height: calc(100vh - 56px); }

    /* Sidebar */
    .sidebar-header { text-align: center; margin-bottom: 2rem; }
    .sidebar-header i { font-size: 2rem; color: var(--secondary); margin-bottom: 0.5rem; }
    .sidebar-header h4, .sidebar-header small { margin: 0; color: var(--secondary); }
    .sidebar-header small { font-size: 0.85rem; opacity: 0.85; }
    #sidebar .nav-link { display: flex; align-items: center; color: var(--secondary); padding: 0.75rem; font-weight: 500; border-radius: 0.375rem; transition: background 0.2s; }
    #sidebar .nav-link:hover, #sidebar .nav-link.active { background: rgba(255,255,255,0.1); }
    #sidebar .nav-link i { margin-right: 0.75rem; }

    /* Topbar */
    .user-info { display: flex; align-items: center; gap: 0.75rem; }
    .user-info span { font-weight: 500; color: var(--text); }
    .btn-logout { color: var(--primary); border: 1px solid var(--primary); font-size: 0.9rem; padding: 0.4rem 0.8rem; border-radius: 0.375rem; background: none; transition: background 0.2s, color 0.2s; }
    .btn-logout:hover { background: var(--primary); color: var(--secondary); }

    /* Content */
    #content h2 { font-size: 1.75rem; color: var(--primary); margin-bottom: 0.5rem; }
    #content p.lead { color: var(--text-muted); margin-bottom: 1.5rem; }

    /* Cards */
    .stats-row { display: flex; gap: 1.5rem; margin-top: 2rem; flex-wrap: wrap; }
    .stats-card { background: var(--card-bg); border-radius: 0.75rem; box-shadow: 0 .5rem 1rem var(--shadow-sm); flex: 1 1 45%; max-width: 45%; padding: 1.75rem 1rem; text-align: center; cursor: pointer; transition: transform .2s, box-shadow .2s; }
    .stats-card:hover { transform: translateY(-4px); box-shadow: 0 1rem 1.5rem var(--shadow-md); }
    .icon-wrapper { width: 64px; height: 64px; background: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: var(--secondary); font-size: 1.75rem; }
    .stats-card h5 { font-weight: 600; margin-bottom: .5rem; }
    .stats-card p.value { font-size: 2.25rem; font-weight: 700; color: var(--primary); margin: 0; }

    /* Modal Anim */
    .modal.fade .modal-dialog { transform: translateY(-50px); transition: transform 0.3s ease-out; }
    .modal.show .modal-dialog { transform: translateY(0); }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <nav id="sidebar">
    <div class="sidebar-header">
      <i class="bi bi-person-heart"></i>
      <h4 th:text="${nombreUsuario}">Paciente</h4>
      <small>Panel Paciente</small>
    </div>
    <ul class="nav flex-column">
      <li class="nav-item"><a class="nav-link active" th:href="@{/paciente/dashboard}"><i class="bi bi-speedometer2"></i> Dashboard</a></li>
      <li class="nav-item"><a class="nav-link" th:href="@{/paciente/mis-citas}"><i class="bi bi-calendar-check"></i> Mis Citas</a></li>
    </ul>
  </nav>

  <!-- Topbar -->
  <div id="topbar">
    <div class="user-info">
      <i class="bi bi-person-circle fs-4 text-muted"></i>
      <span th:text="${nombreUsuario}">Paciente</span>
      <a class="btn-logout btn-sm" th:href="@{/logout}"><i class="bi bi-box-arrow-right me-1"></i>Cerrar Sesión</a>
    </div>
  </div>

  <!-- Main Content -->
  <main id="content">
    <h2>Gestión de tus Citas Médicas</h2>
    <p class="lead">Revisa y administra tus próximas citas de manera sencilla.</p>
    <div class="stats-row">
      <div class="stats-card">
        <div class="icon-wrapper"><i class="bi bi-calendar-event"></i></div>
        <h5>Citas Próximas</h5>
        <p class="value" th:text="${citasProximas}">0</p>
      </div>
      <div class="stats-card" id="tutorialCard">
        <div class="icon-wrapper"><i class="bi bi-play-circle"></i></div>
        <h5>Video Tutorial</h5>
        <p class="value">Ver</p>
      </div>
    </div>
  </main>

  <!-- Video Modal -->
  <div class="modal fade" id="videoModal" tabindex="-1" aria-labelledby="videoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="videoModalLabel">Bienvenida</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-0">
          <video id="welcomeVideo" width="100%" controls playsinline>
            <source th:src="@{/videos/bienvenida.mp4}" type="video/mp4">
            Tu navegador no soporta la reproducción de video.
          </video>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const tutorialCard = document.getElementById('tutorialCard');
    const videoModalEl = document.getElementById('videoModal');
    const video = document.getElementById('welcomeVideo');

    tutorialCard.addEventListener('click', () => {
      const modal = new bootstrap.Modal(videoModalEl);
      modal.show();
      video.currentTime = 0;
      video.play().catch(err => console.warn('Error al reproducir video:', err));
    });

    videoModalEl.addEventListener('hidden.bs.modal', () => {
      video.pause();
    });
  </script>
</body>
</html>
